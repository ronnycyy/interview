/**
 èƒŒåŒ…é—®é¢˜ğŸ’
 ç»™å®šä¸¤ä¸ªé•¿åº¦éƒ½ä¸ºNçš„æ•°ç»„weightså’Œvaluesï¼Œweights[i]å’Œvalues[i]åˆ†åˆ«ä»£è¡¨ iå·ç‰©å“çš„é‡é‡å’Œä»·å€¼ã€‚
 ç»™å®šä¸€ä¸ªæ­£æ•°bagï¼Œè¡¨ç¤ºä¸€ä¸ªè½½é‡bagçš„è¢‹å­ï¼Œä½ è£…çš„ç‰©å“ä¸èƒ½è¶…è¿‡è¿™ä¸ªé‡é‡ã€‚
 è¿”å›ä½ èƒ½è£…ä¸‹çš„æœ€å¤šä»·å€¼ã€‚
*/
function knapsack(weights, values, bag) {
  return dpWays(weights, values, bag);
  return proc(weights, values, 0, bag);
}

// ä»å·¦å¾€å³çš„å°è¯•æ¨¡å‹ï¼Œæ¯ä¸€ä¸ªè´§ç‰©`è¦`æˆ–`ä¸è¦`å…¨å±•å¼€ã€‚

// åœ¨ä¸è¶…è¿‡resté‡é‡çš„æƒ…å†µä¸‹ï¼Œè‡ªç”±é€‰æ‹©[index,N-1]çš„ç‰©å“, è¿”å›æœ€å¤šèƒ½å¾—åˆ°çš„ä»·å€¼ã€‚
function proc(weights, values, index, rest) {
  // å‰©ä½™è½½é‡æ˜¯è´Ÿæ•°ï¼Œè¯´æ˜ä¸Šæ¸¸æœ‰é€‰æ‹©æ˜¯é”™çš„
  // è¿™ä¸ªæ˜¯å·¦ç¥åæ¥åŠ çš„ï¼Œç”±æ­¤å¯è§ï¼Œå°è¯•æ˜¯éå¸¸è½»çš„ï¼Œä¸Šæ¸¸æœ‰ç‰¹æ®Šæƒ…å†µå¤„ç†æ—¶ï¼Œä¸‹æ¸¸åŠ ä¸€ä¸ªbase caseè¿”å›å»ï¼Œå°±èƒ½æ»¡è¶³ã€‚
  if (rest < 0) {
    return -1;  // æœ¬æ¬¡å°è¯•å¤±è´¥ï¼Œè¿”å›-1ç»™ä¸Šä¸€çº§å¤„ç†ã€‚
  }

  // æœ‰å‰©ä½™è½½é‡ï¼Œä½†æ˜¯æ²¡æœ‰è´§ç‰©ğŸ“¦äº†ï¼Œè¿”å›ä»·å€¼0ã€‚
  if (index === weights.length) {
    return 0;
  }

  // index < weights.length 
  // è¿˜æœ‰è´§ç‰©, é¢å¯¹ index å·è´§ç‰©ï¼Œæˆ‘å¯ä»¥é€‰æ‹©`è¦`æˆ–`ä¸è¦`ã€‚

  // å°è¯•1: è¦ index çš„è´§ç‰©
  let p1 = 0;
  const next = proc(weights, values, index + 1, rest - weights[index]);
  // å¦‚æœè¦äº† index è´§ç‰©ï¼Œç»“æœè¶…é‡äº†ï¼Œè¿™ä¸ªå°è¯•å°±æ˜¯å¤±è´¥çš„ï¼Œä»·å€¼ç»´æŒä¸€å¼€å§‹çš„0
  if (next !== -1) {
    // å¦‚æœåˆ°æœ€åæ²¡æœ‰è¶…é‡ï¼Œæœ¬æ¬¡é€‰æ‹©æ–¹æ¡ˆæœ‰æ•ˆï¼Œindexè´§ç‰©çš„ä»·å€¼+åç»­è¿‡ç¨‹çš„ä»·å€¼å’Œ=æœ¬æ¬¡å°è¯•çš„ä»·å€¼ã€‚
    p1 = values[index] + next;
  }

  // å°è¯•2: ä¸è¦ index çš„è´§ç‰©
  // å¾—åˆ° èƒŒåŒ…å‰©ä½™è½½é‡è¿˜æ˜¯restçš„æƒ…å†µä¸‹ï¼Œåœ¨[index+1,N-1]ä¸Šè‡ªç”±é€‰æ‹©è´§ç‰©å¾—åˆ°çš„æœ€å¤§ä»·å€¼
  const p2 = proc(weights, values, index + 1, rest);

  // å½“å‰è´§ç‰©åªèƒ½`é€‰`æˆ–`ä¸é€‰`ï¼Œæ‰€ä»¥è¿”å› `ä¸¤ç§å°è¯•ä¸­ä»·å€¼å¤§çš„é‚£ä¸ª`ã€‚
  return Math.max(p1, p2);
}

// index: 0~weight.length
// rest: 0~bag
function dpWays(weights, values, bag) {
  const N = weights.length + 1;
  const M = bag + 1;
  const dp = Array(N).fill(0).map(_ => new Uint32Array(M));

  //  æœ€åä¸€è¡Œå…¨æ˜¯0ï¼Œé»˜è®¤å°±æ˜¯0ï¼Œä¸ç”¨å¡«

  // ä»å€’æ•°ç¬¬äºŒè¡Œå¼€å§‹ï¼Œä»ä¸‹å¾€ä¸Šï¼Œæ¯è¡Œå†ä»å·¦å¾€å³å¡«
  for (let i = N - 2; i >= 0; i--) {
    for (let j = 0; j < M; j++) {
      let p1 = 0;
      if (j - weights[i] > -1) {
        p1 = values[i] + dp[i + 1][j - weights[i]];
      }
      const p2 = dp[i + 1][j];
      dp[i][j] = Math.max(p1, p2);
    }
  }

  return dp[0][M - 1];
}

// [2,9,5]  w
// [9,5,8]  v
// 10      bag

console.log(knapsack([2, 9, 5], [9, 5, 8], 10));   // 17
